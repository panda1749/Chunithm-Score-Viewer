(function(h){function D(a){function k(){return{fullChain:0,isAllJustice:!1,isFullCombo:!1,isSuccess:!1,level:null,musicId:null,playCount:null,scoreMax:0,scoreRank:0,updateDate:null}}function d(a){return String(a).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}var c=y(),f=g(null,"userFriendGenreVs_result"),h=g([b.o,b.g],null,g([b.s,b.L+q[a.a]],"DifficulityName",["BASIC","ADVANCED","EXPERT","MASTER"][a.a]));e(c,e(f,h));c=[];for(f=0;f<=a.j;f++)c[f]=[];for(var m in a.f){var t=0,l=g([b.P,b.I+q[a.a]],"FriendVS");
e(l,g([b.m,b.K],"vsMusicTitle",e(g(),a.f[m])));f=a.l.c[m];null==f&&(f=k());var n=f.scoreMax,f=z(p(" ",1),p((f.D?"AJ ":f.F?"FC ":"   ")+d(n),0)," ",3);e(l,f);a.b.forEach(function(c){console.log(c.name,m,c.c[m]);var f=c.c[m];null==f&&(f=k());var b=f.scoreMax,r=n-b;0<=r&&t++;var A=0<=r?0:1;if(a.h.max<r||a.h.min>r)A=2;c=z(p(c.name,0),p((f.D?"AJ ":f.F?"FC ":"   ")+d(b),0),(0<=r?"+":"")+d(r),A);e(l,c)});c[t].push(l)}c.forEach(function(a,d){if(0!==a.length){var c=g([b.v,b.R],null,g(null,"GenreName",d+" WIN"));
a.forEach(function(a){e(c,a)});e(h,c)}})}function E(a,k,d,c,f){console.log(arguments);if(0!==k.length){null===d&&(d=2);var b={j:k.length,l:{},b:[],a:d,h:{sort:a,max:f,min:c},f:[],C:[]},e={level:19900+parseInt(d,10),isStatus:!0};x("GetUserMusicApi",e,function(a){this.f=a.musicNameMap;this.C=a.genreMap;this.l=g(a)},b);k.forEach(function(a){e.friendCode=a;x("GetUserMusicApi",e,function(a){this.b.push(g(a));this.j==this.b.length&&D(this)},b)},b);var g=function(a){var c=[];a.userMusicList.forEach(function(a){this[a.musicId]=
a},c);return{name:B(a.userName),c:c}}}}function x(a,b,d,c){b=b||{};b=h.extend({},b);d=d||function(){};d=d.bind(c||this);b.userId=parseInt(getCookie().userId,10);return h.ajax({type:"post",url:REQUEST_URL+a,data:JSON.stringify(b),dataType:"json",scriptCharset:"UTF-8",success:function(c){console.log(a,b,c);null!=c.userId&&window.setCookie("userId",c.userId);d(c)}})}function y(){var a=h("."+b.i).empty();return e(a,u("h2",null,"page_title","\u30d5\u30ec\u30f3\u30c9VS"),u("hr",[b.G,b.g]))}function e(a,
b){var d=h(a);Array.prototype.slice.call(arguments,1).forEach(function(a){d.append(a)});return d}function z(a,k,d,c){var f=g(b.O);d=g({0:"vs_list_count_blue",1:"vs_list_count_red",2:null,3:null}[c],null,d);d=g(b.N,null,d);2===c&&(c={color:"#999"},d.css(c),a&&a.css(c),k&&k.css(c));e(f,a,d,k);return f}function p(a,k){var d=g(b.M);0===k?e(d,g(b.J,"vsMyScore",a)):e(d,a);return d}function u(a,b,d,c){Array.isArray(b)&&(b=b.join(" "));return h(C("<",a,"/>")).attr("id",d).addClass(b).append(c)}function C(a){return Array.prototype.slice.call(arguments,
0).join("")}function B(a){return a.replace(/[\uff01-\uff5e]/g,function(a){return String.fromCharCode(a.charCodeAt(0)-65248)}).replace(/\u201d/g,'"').replace(/\u2019/g,"'").replace(/\u2018/g,"`").replace(/\uffe5/g,"\\").replace(/\u3000/g," ").replace(/\u301c/g,"~")}var g=u.bind(this,"div"),b={i:"frame01_inside",G:"line_dot_black",m:"block_underline",P:"w388",R:"w400",g:"w420",o:"box01",s:"box01_title",u:"box02",v:"box05",H:"mb_20",B:"difficulty_btn_block",A:"difficulty_btn",M:"vs_list_infoblock",O:"vs_list_result_block",
N:"vs_list_result",J:"play_musicdata_highscore",K:"text_b",w:"btn_",I:"musiclist_",L:"title_"},q=["basic","advanced","expart","master"];y();(function(){function a(a){var b=C('<input type="checkbox" name="',a.friendCode,'" />');a=B(a.friendName);b=e(g(),b,a);e(this,b)}function k(a){var b=h(a.target);q.forEach(function(a,c){var d=f+q[c],e=b.hasClass(d)||b.hasClass(d+"_on");p[c].toggleClass(d+"_on",e);p[c].toggleClass(d,!e);e&&(t=c)})}var d=g([b.u,b.g,b.H]);e(h("."+b.i),d);var c=h('<form onsubmit="return false" />'),
f=b.w,p={},m=g(b.B),t=2;q.forEach(function(a,c){var d=g(f+q[c]).click(k);e(m,g(b.A,null,d));p[c]=d});e(c,m);var l=11E5,n=-11E5,v=g(),w=h('<input type="text" size="7" maxlength="7" />').change(function(a){a=h(a.target);var b=a.attr("name"),c=a.val(),d=parseInt(c,10),e=!isNaN(d);if("maxScore"==b){if(!e||11E5<c)d=11E5;l=d}else if("minScore"==b){if(!e||-11E5>c)d=-11E5;n=d}console.log({target:a,name:b,value:c,check:e,setValue:d})}),u=w.clone(!0).attr("name","minScore"),w=w.clone(!0).attr("name","maxScore");
e(v,"\u30b9\u30b3\u30a2\u5dee<br/>",u,"\uff5e",w);e(c,v);v=h('<input type="button" value="\u8aad\u8fbc" onclick="" data-sorttype="1" />').click(function(a){a=parseInt(h(a.target).attr("data-sorttype"),10);var b=[];c.find(":checkbox").each(function(){this.checked&&b.push(this.name)});if(l<n){var d=l;l=n;n=d}E(a,b,t,n,l)});e(d,c,v);x("GetUserFriendlistApi",{state:3},function(b){b=b.userFriendlistList.filter(function(a){return!0===a.isFavorite});b=b.map(function(a){return a.friendCode});var c=[];b.forEach(function(b){b=
x("GetUserFriendNameApi",{friendCode:parseInt(b,10)},a,this);c.push(b)},this);return h.when.apply(this,c)},c)})()})($);
